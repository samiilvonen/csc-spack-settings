modules:
  prefix_inspections:
    include:
    - CPATH
    lib:
    - LIBRARY_PATH
    lib64:
    - LIBRARY_PATH
    man:
    - MANPATH
    share/man:
    - MANPATH
    share/aclocal:
    - ACLOCAL_PATH
  default:
    enable::
    - lmod
    roots:
      lmod: /appl/spack/v023/modulefiles
    lmod:
      hash_length: 0
      core_compilers:
      - gcc@8.5.0
      - gcc@13.3.0
      hierarchy:
      - mpi
      include:
      - 'aocc@5.0.0'
      - amdblis
      - amdfftw
      - amdlibflame
      - amdscalapack
      - aocl-sparse
      - cgal
      - fftw
      - gsl
      - jasper
      - 'gcc@14.2.0'
      - netcdf-c
      - netcdf-fortran
      - parallel-netcdf
      - openblas
      - papi
      - scorep
      - scalasca
      - openmpi
      exclude:
      - '%aocc'
      - '%gcc'
      - '%nvhpc'
      - '%oneapi'
      - '%intel'
      all:
        autoload: none
        conflict:
        - '{name}'
        environment:
          set:
            '{name}_INSTALL_ROOT': '{prefix}'
      amber:
        suffixes:
          +cuda: cuda
      amdblis:
        suffixes:
          threads=openmp: omp
      amdfftw:
        suffixes:
          +openmp: omp
      boost:
        suffixes:
          +mpi: mpi
      cuda:
        environment:
          append_path:
            LIBRARY_PATH: '{prefix}/lib64/stubs'
      fftw:
        suffixes:
          +mpi: mpi
          +openmp: omp
      gcc:
        environment:
          set:
            CC: gcc
            CXX: g++
            FC: gfortran
            F90: gfortran
            F77: gfortran
            I_MPI_CC: gcc
            I_MPI_CXX: g++
            I_MPI_FC: gfortran
            I_MPI_F90: gfortran
            I_MPI_F77: gfortran
      gromacs:
        suffixes:
          +cuda: cuda
          +plumed: plumed
      hdf5:
        suffixes:
          +mpi: mpi
      intel:
        environment:
          set:
            CC: icc
            CXX: icpc
            FC: ifort
            F90: ifort
            F77: ifort
            ICCCFG: /appl/opt/intel_configs/icc_gcc83_csc.cfg
            ICPCCFG: /appl/opt/intel_configs/icpc_gcc83_csc.cfg
            IFORTCFG: /appl/opt/intel_configs/ifort_gcc83_csc.cfg
            I_MPI_CC: icc
            I_MPI_CXX: icpc
            I_MPI_FC: ifort
            I_MPI_F90: ifort
            I_MPI_F77: ifort
      intel-mkl:
        suffixes:
          intel-mkl threads=openmp: omp
      nextflow:
        autoload: all
      openblas:
        suffixes:
          threads=openmp: omp
      openmpi:
        environment:
          set:
            OMPI_MCA_io: ^ompio
            UCX_NET_DEVICES: mlx5_0:1
        suffixes:
          +cuda: cuda
      petsc:
        suffixes:
          +complex+double: cmplx
          +int64: int64
      rclone:
        environment:
          set:
            GOMAXPROCS: '4'
      restic:
        environment:
          set:
            GOMAXPROCS: '4'
  unsupported_set:
    enable::
    - lmod
    roots:
      lmod: /appl/spack/v023/unsupported
    lmod:
      hash_length: 0
      core_compilers:
      - gcc@8.5.0
      - gcc@13.3.0
      hierarchy:
      - mpi
      include:
      - aocc
      - gcc
      exclude:
      - '%aocc'
      - '%gcc'
      - '%nvhpc'
      - '%oneapi'
      - '%intel'
      intel-oneapi-mpi:
        environment:
          prepend_path:
            LD_LIBRARY_PATH: "/appl/opt/ucx/1.12.1/lib:/appl/opt/ucx/1.12.1/lib/ucx"
          set:
            FI_PROVIDER: "mlx"
            I_MPI_PMI_VALUE_LENGTH_MAX: "512"
            SLURM_MPI_TYPE: "pmi2"
  testing_set:
    enable::
    - lmod
    roots:
      lmod: /appl/spack/v023/testing
    lmod:
      hash_length: 0
      core_compilers:
      - gcc@8.5.0
      - gcc@13.3.0
      hierarchy:
      - mpi
      include:
      - aocc
      - amdblis
      - amdfftw
      - amdlibflame
      - amdscalapack
      - aocl-sparse
      - openmpi
      exclude:
      - '%aocc'
      - '%gcc'
      - '%nvhpc'
      - '%oneapi'
      - '%intel'
      intel-oneapi-mpi:
        environment:
          prepend_path:
            LD_LIBRARY_PATH: "/appl/opt/ucx/1.12.1/lib:/appl/opt/ucx/1.12.1/lib/ucx"
          set:
            FI_PROVIDER: "mlx"
            I_MPI_PMI_VALUE_LENGTH_MAX: "512"
            SLURM_MPI_TYPE: "pmi2"

